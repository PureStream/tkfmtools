(self.webpackChunktkfmtools=self.webpackChunktkfmtools||[]).push([[302],{26465:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var r=n(19756),a=n(85061),i=n(67294),l=n(50009),o=n(54480),c=n(57954),s=n(47378),u=n(94770),m=n(17182),f=n(27859),d=n(55317),p=n(93175),g=n(42474),h=n(28437),y=n(20156),E={};y.forEach((function(e){e.stages.forEach((function(t){var n=t.materials,a=t.trainItems,i=t.expPotions,l=(0,r.Z)(t,["materials","trainItems","expPotions"]);[n,a,i].forEach((function(t){t.forEach((function(t){var n=Object.assign({chapter:e.chapter,rarity:t.rarity},l);E[t.id]?E[t.id].drop.push(n):E[t.id]={drop:[n]}}))}))}))}));for(var b=1;b<11;b++)E[(500+b).toString()]={drop:[]};for(var v=1;v<3;v++)E[(900+v).toString()]={drop:[]};var k=E,S={en:{1360:4,992:3,768:4,624:3,0:2},"zh-TW":{1360:5,992:4,768:5,624:4,410:3,0:2}},I=(0,l.ZP)(d.K).withConfig({displayName:"filter__StyledToggleButton",componentId:"sc-1e6kgg1-0"})(["display:flex;justify-content:center;align-items:center;font-size:.85rem;"]),C=(0,l.ZP)(p.Z).withConfig({displayName:"filter__ItemImg",componentId:"sc-1e6kgg1-1"})(["width:2.26rem;height:2.26rem;"]),Z=function(e){var t=e.filterBtnValue,n=e.filterBy,r=e.clearBtnValue,a=(0,c.f)(),l=a.userLanguage,o=a.pageString,s=a.itemString;return i.createElement(i.Fragment,null,i.createElement(m.Z,{title:o.items.drop.filter.itemPanelTitle,end:i.createElement(f.Io,{onClick:r,tooltipText:o.items.drop.filter.deleteTooltip},h.pJ),border:!0}),i.createElement(d.Z,{type:"checkbox",value:t,onChange:n,layoutConfig:S[l]},Object.entries(k).map((function(e,t){return 0===e[1].drop.length||i.createElement(I,{value:e[0],key:t},i.createElement(C,{name:"item_"+e[0],alt:""}),s.name[e[0]])}))))},B=(0,l.ZP)(u.Re).withConfig({displayName:"filter__ImgTh",componentId:"sc-1e6kgg1-2"})(["&:after{position:absolute;top:calc(50% - .75rem);margin-left:2rem;}"]),O=(0,l.ZP)(p.Z).withConfig({displayName:"filter__TableImg",componentId:"sc-1e6kgg1-3"})(["width:1.8rem;height:1.8rem;"]),_=function(e){var t=e.requestSort,n=e.getSortDirection,r=e.sortedResult,a=(0,c.f)(),l=a.pageString,o=a.itemString;return 0===r.length?i.createElement(u.Re,null,l.items.drop.filter.tableHead[1]):Object.entries(r[0]).map((function(e,r){if("stage"!==e[0]&&"energy"!==e[0])return i.createElement(B,{key:r,onClick:function(){return t(e[0])},direction:n(e[0])},i.createElement(O,{name:"item_"+e[0],alt:o.name[e[0]]}))}))},j=function(e){var t=e.requestSort,n=e.getSortDirection,r=e.sortedResult,a=(0,c.f)().pageString;return i.createElement("thead",null,i.createElement("tr",null,i.createElement(u.Re,{onClick:function(){return t("stage")},direction:n("stage")},a.items.drop.filter.tableHead[0]),i.createElement(_,{requestSort:t,getSortDirection:n,sortedResult:r}),i.createElement(B,{onClick:function(){return t("energy")},direction:n("energy")},i.createElement(O,{name:"energy",alt:a.items.drop.filter.tableHead[2]}))))},P=function(e){var t=e.sortedResult,n=(0,c.f)().itemString;return i.createElement("tbody",null,t.map((function(e,t){return i.createElement("tr",{key:t},i.createElement("td",null,e.stage),Object.entries(e).map((function(e,t){if("stage"!==e[0]&&"energy"!==e[0])return i.createElement("td",{key:t},n.rarity[e[1]])})),i.createElement("td",null,e.energy))})))},V=function(e,t){var n=function(e){var t=e.split("-");return 1e3*parseInt(t[0])+10*parseInt(t[1].split(" ")[0])+(t[1].includes("free")?1:0)+(t.length>2?parseInt(t[2]):0)};e.sort((function(e,r){var a,i;return"stage"===t.key?(a=n(e.stage),i=n(r.stage)):(a=e[t.key],i=r[t.key]),a<i?"asc"===t.direction?-1:1:a>i?"asc"===t.direction?1:-1:0}))},w=function(){var e=(0,c.f)().pageString,t=(0,i.useState)({filterBtnValue:[],data:[],isHelpModalOpen:!1}),n=t[0],l=t[1],m=function(e){var t;if(0!==e.length){var n=(t=[]).concat.apply(t,(0,a.Z)(y.map((function(e){return e.stages.map((function(t){var n=t.materials,a=t.trainItems,i=t.expPotions,l=(0,r.Z)(t,["materials","trainItems","expPotions"]);return Object.assign({},l,{drops:n.concat(a,i),chapter:e.chapter})}))})))).filter((function(t){return e.every((function(e){var n=!1;return t.drops.forEach((function(t){if(t.id===e)return n=!0,!1})),n}))}));n=n.map((function(t){var n={stage:t.chapter+"-"+t.stage,energy:t.energy};return t.drops.forEach((function(t){e.includes(t.id)&&(n[t.id]=t.rarity)})),n})),l((function(t){return Object.assign({},t,{filterBtnValue:e,data:n})}))}else l((function(t){return Object.assign({},t,{filterBtnValue:e,data:[]})}))},f=function(e){return function(){l((function(t){return Object.assign({},t,{isHelpModalOpen:e})}))}};return i.createElement(i.Fragment,null,i.createElement(s.Z,{title:e.items.drop.filter.helmet.title,description:e.items.drop.filter.helmet.description,path:"/items/drop/filter/"}),i.createElement(o.Z,{panelsWidth:["62%","38%"]},i.createElement(Z,{filterBtnValue:n.filterBtnValue,filterBy:m,clearBtnValue:function(){return m([])}}),i.createElement(u.Ac,{data:n.data,head:i.createElement(j,null),body:i.createElement(P,null),sortFunc:V,defaultSortKey:n.filterBtnValue[0],handleModalOpen:f(!0),maxHeight:"calc(100vh - 16rem)",striped:!0})),i.createElement(g.p2,{title:e.items.drop.filter.helpModal.title,open:n.isHelpModalOpen,onClose:f(!1),content:e.items.drop.filter.helpModal.content,ariaLabelledby:"help-modal-title",ariaDescribedby:"help-modal-description"}))}}}]);
//# sourceMappingURL=component---src-pages-items-drop-filter-js-67367ca1a84071eb8927.js.map